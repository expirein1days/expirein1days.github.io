(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{1742:function(e,t,a){},1781:function(e,t,a){"use strict";a.r(t);var r=a(12),i=a.n(r),n=a(14),l=a(9),c=a(0),s=a.n(c),o=a(891),h=a(19),d=a(144),f=a(474),u=a(145),p=a(142),g=a(16),b=a(20);function m(e){var t=Object(c.useContext)(b.a),a=Object(c.useRef)(null),r=e.type,i=e.onClick,n=e.active,l=Object(u.a)(e,["type","onClick","active"]),h="fillterPickerItem".concat(r);function d(e,t,a){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;t&&(t.filters[r]=a,t.applyFilters(),e.renderAll())}return Object(c.useEffect)(function(){if(e.pictureData){var t=o.fabric.Image.filters;if(a.current){var i=new o.fabric.Canvas(a.current,{enableRetinaScaling:!1});o.fabric.Image.fromURL(e.pictureData.smallUri||e.pictureData.uri,function(e){e.height>=e.width?(e.scaleToWidth(90),e.set({left:0,top:-(e.height*(90/e.width)-90)/2}).setCoords()):(e.scaleToHeight(90),e.set({left:-(e.width*(90/e.height)-90)/2,top:0}).setCoords());var a=new o.fabric.Rect({width:90,height:90,fill:"red",lockMovementX:!0,lockMovementY:!0,lockScalingX:!0,lockScalingY:!0,lockRotation:!0,lockSkewingX:!0,lockScalingFlip:!0,lockSkewingY:!0,lockUniScaling:!0,hasBorders:!1,hasControls:!1,hasRotatingPoint:!1});i.clipPath=a,i.add(e),i.renderAll(),"original"===r||("high_contrast"===r?(d(i,e,new t.Contrast({contrast:1})),d(i,e,new t.BlackWhite)):"monochrome"===r?d(i,e,new t.Grayscale):"fade"===r?d(i,e,new t.ColorMatrix({matrix:[.69289941361155,.7278445092038974,-.05512249038767107,0,0,.1613074605810542,1.0992559191682274,.13496294539414613,0,0,.3215407473339169,.5219370160799921,.475247644029788,0,0,0,0,0,1,0]})):"process"===r?d(i,e,new t.ColorMatrix({matrix:[.9923434290993866,.020245983284966663,.05808604318498348,0,0,.12115038437773568,.835385137906068,.05372603236979564,0,0,.19202559992747836,.21537620720368716,.9342355235475182,0,0,0,0,0,1,0]})):"chrome"===r&&d(i,e,new t.ColorMatrix({matrix:[1.6625074707000003,-.12036142800000012,-.012146042700000012,0,0,-.035792529300000035,1.5779385719999999,-.012146042700000012,0,0,-.035792529300000035,-.12036142800000012,1.6861539573000002,0,0,0,0,0,1,0]})))},{hasControls:!1,lockMovementX:!0,lockMovementY:!0})}}},[e.pictureData,a]),s.a.createElement("div",Object.assign({onClick:function(){i()},style:{height:120}},l),s.a.createElement("div",{style:{borderWidth:2,borderStyle:"solid",borderColor:n?"#1b1b1b":"transparent",padding:2}},s.a.createElement("div",{style:{width:90,height:90,backgroundColor:"#FFF",overflow:"hidden"}},s.a.createElement("canvas",{ref:a,id:h,width:90}))),s.a.createElement("div",{style:{height:17,lineHeight:"26px",fontFamily:"ja"===t.current?"NotoSansCJKjp-Bold":"initial",fontWeight:"ja"===t.current?"initial":"bold",fontSize:11,color:"#7D7D7D",textAlign:"center"}},e.label))}function w(e){var t=Object(c.useState)("original"),r=Object(l.a)(t,2),i=r[0],n=r[1],o=Object(c.useState)(!1),h=Object(l.a)(o,2),d=h[0],f=h[1],u=Object(c.useContext)(b.a);function w(t,a){return function(){e.onChange(t),n(t),a()}}return s.a.createElement(p.a,{renderOverlay:function(t){var a=t.triggerRect,r=t.closePopup,n=t.visible;if(f(n),!a)return s.a.createElement("div",null);window.innerHeight,a.top;return s.a.createElement("div",{style:{position:"absolute",backgroundColor:"#FFF",width:window.innerWidth,bottom:102,zIndex:12,height:364}},s.a.createElement("div",{style:{position:"absolute",bottom:-26,left:27}},s.a.createElement("svg",{width:"30",height:"24",viewBox:"0 0 30 24"},s.a.createElement("path",{fill:"#fff",d:"M30 0 L15 20 L 0 0 z"}))),s.a.createElement("div",{style:{fontSize:"ja"===u.current?"17px":"20px",color:"#1B1B1B",lineHeight:"56px",fontFamily:"ja"===u.current?"NotoSansCJKjp-Bold":"initial",height:56,boxShadow:"inset 0 -1px 0 0 #DADADA",textAlign:"center",fontWeight:"ja"===u.current?"initial":"bold"}},s.a.createElement(g.a,{code:"make.picture.filterPickerTitle"})),s.a.createElement("div",{style:{padding:22}},s.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:20}},s.a.createElement(m,{pictureData:e.pictureData,active:"original"===i,onClick:w("original",r),type:"original",label:"ja"===u.current?"\u8abf\u6574\u306a\u3057":"None"}),s.a.createElement(m,{pictureData:e.pictureData,active:"monochrome"===i,onClick:w("monochrome",r),type:"monochrome",label:"ja"===u.current?"\u30e2\u30ce\u30af\u30ed":"Monochrome"}),s.a.createElement(m,{pictureData:e.pictureData,active:"high_contrast"===i,onClick:w("high_contrast",r),type:"high_contrast",label:"ja"===u.current?"\u30cf\u30a4\u30b3\u30f3\u30c8\u30e9\u30b9\u30c8":"High Contrast"})),s.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},s.a.createElement(m,{pictureData:e.pictureData,active:"process"===i,onClick:w("process",r),type:"process",label:"ja"===u.current?"\u30d7\u30ed\u30bb\u30b9":"Process"}),s.a.createElement(m,{pictureData:e.pictureData,active:"fade"===i,onClick:w("fade",r),type:"fade",label:"ja"===u.current?"\u30d5\u30a7\u30fc\u30c9":"Fade"}),s.a.createElement(m,{pictureData:e.pictureData,active:"chrome"===i,onClick:w("chrome",r),type:"chrome",label:"ja"===u.current?"\u30af\u30ed\u30fc\u30e0":"Chrome"}))))}},s.a.createElement("div",{id:"FiltersIcons",style:{borderRadius:25,width:50,height:50,zIndex:d?13:11,position:"absolute"}},s.a.createElement("span",null,s.a.createElement("img",{src:a(1195),alt:"",style:{width:"100%",height:"100%"}}))))}a(1742);var U=a(1196),v=a.n(U),y=a(597),O=a.n(y),k=a(604),j=a.n(k),E=a(603),x=a.n(E),C=a(582),S=a.n(C),F=a(583),I=a.n(F),D=a(584),L=a.n(D),B=a(585),M=a.n(B),A=a(586),R=a.n(A),P=a(598),z=a.n(P),N=a(588),T=a.n(N),W=a(587),_=a.n(W),H=a(605),G=a.n(H),J=a(606),K=a.n(J),X=a(607),Y=a.n(X),V=a(608),Z=a.n(V),q=a(609),Q=a.n(q),$=a(599),ee=a.n($),te=a(600),ae=a.n(te),re=a(601),ie=a.n(re),ne=a(602),le=a.n(ne),ce=a(593),se=a.n(ce),oe=a(594),he=a.n(oe),de=a(595),fe=a.n(de),ue=a(596),pe=a.n(ue),ge=a(589),be=a.n(ge),me=a(590),we=a.n(me),Ue=a(591),ve=a.n(Ue),ye=a(592),Oe=a.n(ye),ke=a(610),je=a.n(ke),Ee=a(611),xe=a.n(Ee),Ce=a(612),Se=a.n(Ce),Fe=a(613),Ie=a.n(Fe),De=a(468),Le=a.n(De),Be=a(471),Me=a.n(Be),Ae=a(470),Re=a.n(Ae),Pe=a(465),ze=a.n(Pe),Ne=a(708),Te=a.n(Ne),We=a(709),_e=a.n(We),He=a(710),Ge=a.n(He),Je=a(711),Ke=a.n(Je),Xe=a(469),Ye=a.n(Xe),Ve=a(467),Ze=a.n(Ve),qe=a(466),Qe=a.n(qe),$e=a(472),et=a.n($e),tt=a(724),at=a.n(tt),rt=a(725),it=a.n(rt),nt=a(726),lt=a.n(nt),ct=a(727),st=a.n(ct),ot=a(720),ht=a.n(ot),dt=a(721),ft=a.n(dt),ut=a(722),pt=a.n(ut),gt=a(723),bt=a.n(gt),mt=a(716),wt=a.n(mt),Ut=a(717),vt=a.n(Ut),yt=a(718),Ot=a.n(yt),kt=a(719),jt=a.n(kt),Et=a(712),xt=a.n(Et),Ct=a(713),St=a.n(Ct),Ft=a(714),It=a.n(Ft),Dt=a(715),Lt=a.n(Dt),Bt=a(728),Mt=a.n(Bt),At=a(729),Rt=a.n(At),Pt=a(730),zt=a.n(Pt),Nt=a(731),Tt=a.n(Nt);var Wt=function(e){var t=[{id:1,srcUrl:O.a,srcUrlOff:Le.a,type:!0},{id:2,srcUrl:j.a,srcUrlOff:Me.a,type:!1},{id:3,srcUrl:x.a,srcUrlOff:Re.a,type:!1},{id:4,srcUrl:S.a,srcUrlOff:ze.a,type:!1},{id:5,srcUrl:I.a,srcUrlOff:Te.a,type:!1},{id:6,srcUrl:L.a,srcUrlOff:_e.a,type:!1},{id:7,srcUrl:M.a,srcUrlOff:Ge.a,type:!1},{id:8,srcUrl:R.a,srcUrlOff:Ke.a,type:!1},{id:9,srcUrl:z.a,srcUrlOff:Ye.a,type:!1},{id:10,srcUrl:T.a,srcUrlOff:Ze.a,type:!1},{id:11,srcUrl:_.a,srcUrlOff:Qe.a,type:!1},{id:12,srcUrl:G.a,srcUrlOff:et.a,type:!1},{id:13,srcUrl:K.a,srcUrlOff:at.a,type:!1},{id:14,srcUrl:Y.a,srcUrlOff:it.a,type:!1},{id:15,srcUrl:Z.a,srcUrlOff:lt.a,type:!1},{id:16,srcUrl:Q.a,srcUrlOff:st.a,type:!1},{id:17,srcUrl:ee.a,srcUrlOff:ht.a,type:!1},{id:18,srcUrl:ae.a,srcUrlOff:ft.a,type:!1},{id:19,srcUrl:ie.a,srcUrlOff:pt.a,type:!1},{id:20,srcUrl:le.a,srcUrlOff:bt.a,type:!1},{id:21,srcUrl:se.a,srcUrlOff:wt.a,type:!1},{id:22,srcUrl:he.a,srcUrlOff:vt.a,type:!1},{id:23,srcUrl:fe.a,srcUrlOff:Ot.a,type:!1},{id:24,srcUrl:pe.a,srcUrlOff:jt.a,type:!1},{id:25,srcUrl:be.a,srcUrlOff:xt.a,type:!1},{id:26,srcUrl:we.a,srcUrlOff:St.a,type:!1},{id:27,srcUrl:ve.a,srcUrlOff:It.a,type:!1},{id:28,srcUrl:Oe.a,srcUrlOff:Lt.a,type:!1},{id:29,srcUrl:je.a,srcUrlOff:Mt.a,type:!1},{id:30,srcUrl:xe.a,srcUrlOff:Rt.a,type:!1},{id:31,srcUrl:Se.a,srcUrlOff:zt.a,type:!1},{id:32,srcUrl:Ie.a,srcUrlOff:Tt.a,type:!1}],a=Object(c.useState)(window.innerWidth),r=Object(l.a)(a,1)[0],i=Object(c.useState)(window.innerHeight),n=Object(l.a)(i,1)[0],o=Object(c.useState)(!0),h=Object(l.a)(o,2),d=h[0],f=h[1],u=Object(c.useState)(t),p=Object(l.a)(u,2),m=p[0],w=p[1],U=Object(c.useState)(!0),y=Object(l.a)(U,2),k=y[0],E=y[1],C=Object(c.useContext)(b.a);function F(t){var a=e.onSelectShape;f(!d),a&&k&&("box"!==t&&a(m[0].id,m[0].srcUrl,"change\bShape"),E(!1))}return Object(c.useEffect)(function(){for(var e=0;e<m.length;e++)1===m[e].id?m[e].type=!0:m[e].type=!1},[]),s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"box"},d?s.a.createElement("div",{className:"model",style:{width:r,height:n}},s.a.createElement("div",{className:"boxWrap"},s.a.createElement("div",{className:"mask",onClick:function(){return F()}}),s.a.createElement("div",{className:"popupModel",style:{width:r,height:"75%"}},s.a.createElement("div",{style:{fontSize:"ja"===C.current?"17px":"20px",color:"#1B1B1B",lineHeight:"56px",fontFamily:"ja"===C.current?"NotoSansCJKjp-Bold":"initial",fontWeight:"ja"===C.current?"initial":"bold",height:56,boxShadow:"inset 0 -1px 0 0 #DADADA",textAlign:"center"}},s.a.createElement(g.a,{code:"make.item.shape.title"})),s.a.createElement("div",{className:"content",style:{height:444/667*n,backgroundColor:"white"}},s.a.createElement("ul",{className:"svgList"},m.map(function(t,a){return s.a.createElement("li",{style:{width:(window.innerWidth-75)/4,height:(window.innerWidth-75)/4,position:"relative"},key:a,onClick:function(){return function(t){var a=e.onSelectShape;a&&a(t.id,t.srcUrl,"change\bShape");for(var r=t.id,i=0;i<m.length;i++)r===m[i].id?m[i].type=!0:m[i].type=!1;w(m),F("box")}(t)}},t.type?s.a.createElement("img",{src:t.srcUrl,alt:"\u526a\u5207\u7c7b\u578b\u56fe\u6807---\u9009\u4e2d\u72b6\u6001",width:"75",height:"75",style:{position:"absolute",left:"50%",marginLeft:-37.5,top:"50%",marginTop:-37.5}}):s.a.createElement("img",{src:t.srcUrlOff,alt:"\u526a\u5207\u7c7b\u578b\u56fe\u6807---\u672a\u9009\u4e2d\u72b6\u6001",width:"75",height:"75",style:{position:"absolute",left:"50%",marginLeft:-37.5,top:"50%",marginTop:-37.5}}))})),s.a.createElement("div",{style:{height:"0.75rem"}})),s.a.createElement("div",{style:{position:"absolute",bottom:-26,left:"50%",marginLeft:-15}},s.a.createElement("svg",{width:"30",height:"24",viewBox:"0 0 30 24"},s.a.createElement("path",{fill:"#fff",d:"M30 0 L15 20 L 0 0 z"})))))):null,s.a.createElement("div",{className:d?"iconWrap activeIcon":"iconWrap"},s.a.createElement("img",{className:"icon",onClick:function(){return F()},src:v.a,alt:"\u622a\u53d6\u6846\u56fe\u6807"}))))},_t=a(56),Ht=a(454),Gt=a(1041),Jt=a(644),Kt=a.n(Jt),Xt=a(658),Yt=a.n(Xt),Vt=a(656),Zt=a.n(Vt),qt=a(614),Qt=a.n(qt),$t=a(616),ea=a.n($t),ta=a(618),aa=a.n(ta),ra=a(620),ia=a.n(ra),na=a(622),la=a.n(na),ca=a(646),sa=a.n(ca),oa=a(626),ha=a.n(oa),da=a(624),fa=a.n(da),ua=a(660),pa=a.n(ua),ga=a(662),ba=a.n(ga),ma=a(664),wa=a.n(ma),Ua=a(666),va=a.n(Ua),ya=a(668),Oa=a.n(ya),ka=a(648),ja=a.n(ka),Ea=a(650),xa=a.n(Ea),Ca=a(652),Sa=a.n(Ca),Fa=a(654),Ia=a.n(Fa),Da=a(636),La=a.n(Da),Ba=a(638),Ma=a.n(Ba),Aa=a(640),Ra=a.n(Aa),Pa=a(642),za=a.n(Pa),Na=a(628),Ta=a.n(Na),Wa=a(630),_a=a.n(Wa),Ha=a(632),Ga=a.n(Ha),Ja=a(634),Ka=a.n(Ja),Xa=a(670),Ya=a.n(Xa),Va=a(672),Za=a.n(Va),qa=a(674),Qa=a.n(qa),$a=a(676),er=a.n($a),tr=a(645),ar=a.n(tr),rr=a(659),ir=a.n(rr),nr=a(657),lr=a.n(nr),cr=a(615),sr=a.n(cr),or=a(617),hr=a.n(or),dr=a(619),fr=a.n(dr),ur=a(621),pr=a.n(ur),gr=a(623),br=a.n(gr),mr=a(647),wr=a.n(mr),Ur=a(627),vr=a.n(Ur),yr=a(625),Or=a.n(yr),kr=a(661),jr=a.n(kr),Er=a(663),xr=a.n(Er),Cr=a(665),Sr=a.n(Cr),Fr=a(667),Ir=a.n(Fr),Dr=a(669),Lr=a.n(Dr),Br=a(649),Mr=a.n(Br),Ar=a(651),Rr=a.n(Ar),Pr=a(653),zr=a.n(Pr),Nr=a(655),Tr=a.n(Nr),Wr=a(637),_r=a.n(Wr),Hr=a(639),Gr=a.n(Hr),Jr=a(641),Kr=a.n(Jr),Xr=a(643),Yr=a.n(Xr),Vr=a(629),Zr=a.n(Vr),qr=a(631),Qr=a.n(qr),$r=a(633),ei=a.n($r),ti=a(635),ai=a.n(ti),ri=a(671),ii=a.n(ri),ni=a(673),li=a.n(ni),ci=a(675),si=a.n(ci),oi=a(677),hi=a.n(oi),di=[{id:1,srcUrl:Kt.a,srcUrlFill:ar.a},{id:2,srcUrl:Yt.a,srcUrlFill:ir.a},{id:3,srcUrl:Zt.a,srcUrlFill:lr.a},{id:4,srcUrl:Qt.a,srcUrlFill:sr.a},{id:5,srcUrl:ea.a,srcUrlFill:hr.a},{id:6,srcUrl:aa.a,srcUrlFill:fr.a},{id:7,srcUrl:ia.a,srcUrlFill:pr.a},{id:8,srcUrl:la.a,srcUrlFill:br.a},{id:9,srcUrl:sa.a,srcUrlFill:wr.a},{id:10,srcUrl:ha.a,srcUrlFill:vr.a},{id:11,srcUrl:fa.a,srcUrlFill:Or.a},{id:12,srcUrl:pa.a,srcUrlFill:jr.a},{id:13,srcUrl:ba.a,srcUrlFill:xr.a},{id:14,srcUrl:wa.a,srcUrlFill:Sr.a},{id:15,srcUrl:va.a,srcUrlFill:Ir.a},{id:16,srcUrl:Oa.a,srcUrlFill:Lr.a},{id:17,srcUrl:ja.a,srcUrlFill:Mr.a},{id:18,srcUrl:xa.a,srcUrlFill:Rr.a},{id:19,srcUrl:Sa.a,srcUrlFill:zr.a},{id:20,srcUrl:Ia.a,srcUrlFill:Tr.a},{id:21,srcUrl:La.a,srcUrlFill:_r.a},{id:22,srcUrl:Ma.a,srcUrlFill:Gr.a},{id:23,srcUrl:Ra.a,srcUrlFill:Kr.a},{id:24,srcUrl:za.a,srcUrlFill:Yr.a},{id:25,srcUrl:Ta.a,srcUrlFill:Zr.a},{id:26,srcUrl:_a.a,srcUrlFill:Qr.a},{id:27,srcUrl:Ga.a,srcUrlFill:ei.a},{id:28,srcUrl:Ka.a,srcUrlFill:ai.a},{id:29,srcUrl:Ya.a,srcUrlFill:ii.a},{id:30,srcUrl:Za.a,srcUrlFill:li.a},{id:31,srcUrl:Qa.a,srcUrlFill:si.a},{id:32,srcUrl:er.a,srcUrlFill:hi.a}],fi=a(11),ui=a(150),pi=a(460),gi=a(47),bi=a(447),mi=a(146),wi=a(147),Ui=a(1047),vi=a(473),yi=a(24),Oi=function(e){var t=e.integrationTop,a=e.integrationLeft,r="",i="",n=null,l=null,c=null,s=null,o=e.shapId,h=(e.obj,e.size),d=e.imgObj,f=e.canvasSize,u=(e.areaStyle,e.canvasArea),p=null;switch(o){case 1:t=t-64-5,a+=9.5,r="height",i=1158;break;case 6:a-=19,t-=17,r="width",i=1073;break;case 10:t-=58,a+=3,r="height",i=1156;break;case 11:a+=5,t+=7,r="width",i=1032;break;case 15:a-=76,r="height",i=1162;break;case 16:a-=76,t-=1,r="height",i=1162;break;case 25:case 26:a-=72,t-=64,r="width",i=1178;break;case 30:a-=12,t-=12,r="width",i=1058;break;default:r="width",i=1035.2}if("change\bShape"===h)if(d.width<d.height)switch(p="true",o){case 1:n=1021/d.width,l=(f-d.width*n)/2-3,c=t+63+(1152-d.height*n)/2-64+64+4,a-=68;break;case 6:n=1021/d.width,l=a+19.9,c=t+(1152-d.height*n)/2-64+64;break;case 10:n=1024/d.width,l=a-4,c=t+(1152-d.height*n)/2-64+64+58,a-=76.5;break;case 11:n=1022/d.width,l=a-4.6,c=t+(1152-d.height*n)/2-64+55,a-=4;break;case 14:n=1024/d.width,l=a,c=t+(1152-d.height*n)/2-64+64;break;case 15:case 16:n=1024/d.width,l=a+76,c=t+(1152-d.height*n)/2-64+64,t-=64;break;case 17:case 18:case 19:case 20:n=1016/d.width,l=a+4,c=t+(1152-d.height*n)/2;break;case 25:case 26:n=1021/d.width,l=a+71,c=t+(1152-d.height*n)/2+64+4;break;case 30:n=1021/d.width,l=a+12,c=t+(1152-d.height*n)/2;break;default:n=1021/d.width,l=a+2,c=t+(1152-d.height*n)/2-6}else switch(p="false",o){case 10:n=1152/d.height,l=u.left-(d.width*n-1024)/2,c=t+64.5,a-=76.5;break;case 11:d.width*(885.76/d.height)<1024?(n=1024/d.width,c=t-(d.height*n-1152)/2):(n=885.76/d.height,c=t+135),l=u.left-(d.width*n-1024)/2,a-=4;break;case 12:s=t+92,n=972.8/d.height,l=u.left-(d.width*n-1024)/2,c=s;break;case 13:case 14:d.width*(889/d.height)<1024?(n=1024/d.width,c=t-(d.height*n-1152)/2):(n=889/d.height,c=t+132),l=u.left-(d.width*n-1024)/2;break;case 15:case 16:n=1152/d.height,l=u.left-(d.width*n-1024)/2,c=t,t-=64;break;case 1:a-=68,n=1154/d.height,l=u.left-(d.width*n-1024)/2,c=t+64+5;break;case 5:n=1025/d.height,l=u.left-(d.width*n-1024)/2,c=t+64;break;case 6:n=1064/d.height,l=u.left-(d.width*n-1024)/2,c=t+64+1;break;case 25:case 26:n=1154/d.height,l=u.left-(d.width*n-1024)/2,c=t+64;break;case 27:case 28:d.width*(912/d.height)<1024?(n=1024/d.width,c=t-(d.height*n-1152)/2+4):(n=912/d.height,c=t+64+62),l=u.left-(d.width*n-1024)/2;break;case 29:n=1004/d.height,l=u.left-(d.width*n-1024)/2,c=t+64+10;break;case 30:n=1046/d.height,l=u.left-(d.width*n-1024)/2,c=t+64;break;default:n=1030/d.height,l=u.left-(d.width*n-1024)/2,c=t+64+2}else if("itemSwitch"===h)if(d.width<d.height)switch(p="true",o){case 1:a-=68;break;case 10:a-=76.5;break;case 11:a-=4;break;case 15:case 16:t-=(u.height-1024)/2}else switch(p="false",o){case 1:a-=68;break;case 10:a-=76.5;break;case 11:a-=4;break;case 15:case 16:t-=(u.height-1024)/2}return{left:a-3,top:t-1,width:1024,height:1152,scaleType:r,scaleNumber:i,bigMultiples:n,imgObjLeft:l,imgObjTop:c,type:p}},ki=function(e,t,a){var r=null,i=null,n=null;switch(t){case 1:r=e.width+30,i=e.left-16.5,n=e.top-2;break;case 6:r=e.width+12,i=e.left-6,n=e.top+12;break;case 10:r=e.width+32,i=e.left-19,n=e.top+2;break;case 11:r=e.width+2,i=e.left-1,n=e.top+18;break;case 14:r=e.width+3.6,i=e.left-1.6,n=e.top+32.6;break;case 15:case 16:r=e.width+2,i=e.left-1,n=e.top-1.5;break;case 25:case 26:r=e.width+38,i=e.left-19,n=e.top;break;case 30:r=e.width+8,i=e.left-4,n=e.top+(e.height-e.width)/2-4;break;case 32:r=e.width+2,i=e.left-1,n=e.top+(e.height-e.width)/2;break;default:r=e.width+3,i=e.left-1,n=e.top+(e.height-e.width)/2}return{width:r,left:i,top:n}},ji=a(25),Ei=a(84),xi=0,Ci=null,Si=null,Fi=null,Ii=null,Di=null,Li=null,Bi=!0,Mi=null,Ai=null,Ri=null;t.default=Object(wi.a)("photo")(function(e){var t=Object(c.useContext)(h.a),a=e.pictureData,r=t.layers,u=t.previousPage,p=Object(c.useContext)(_t.a),g=Object(c.useState)(),b=Object(l.a)(g,2),m=b[0],U=b[1],v=Object(c.useState)(!1),y=Object(l.a)(v,2),O=y[0],k=y[1],j=p.canvasSize,E=p.imageSize,x=p.areaStyle,C=p.canvasArea,S=Object(c.useState)(di),F=Object(l.a)(S,2),I=F[0],D=(F[1],Object(c.useState)(!1)),L=Object(l.a)(D,2),B=L[0],M=L[1],A=Object(c.useState)(x.width),R=Object(l.a)(A,2),P=(R[0],R[1],Object(c.useState)(x.height)),z=Object(l.a)(P,2),N=(z[0],z[1],Object(c.useState)(x.left)),T=Object(l.a)(N,2),W=(T[0],T[1],Object(c.useState)(x.top)),_=Object(l.a)(W,2),H=(_[0],_[1],Object(c.useState)(!1)),G=Object(l.a)(H,2),J=G[0],K=G[1],X=Object(c.useState)(null),Y=Object(l.a)(X,2),V=Y[0],Z=Y[1],q=(r&&r[r.length-2],Object(c.useRef)());function Q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=m.getObjects()[0];a&&(a.filters[t]=e,a.applyFilters(),m.renderAll())}function $(e){k(e)}Object(c.useEffect)(function(){if(Object(gi.a)(),Ai=C.top,Ri=C.left,!m)return U(new o.fabric.Canvas("picture_canvas",{enableRetinaScaling:!1})),setTimeout(function(){p.setZoom(!0)},800),function(){}},[]),Object(c.useEffect)(function(){parseInt(Ai)!==parseInt(C.top)&&te(j,E,C,Ii,Di,"itemSwitch")},[C],j,E),Object(c.useEffect)(function(){m&&a&&(document.getElementsByClassName("canvas-container")[0].onclick=function(){$(!1)},o.fabric.Image.fromURL(a.uri,function(e){Z(e)}))},[a,m]);var ee=Object(c.useCallback)(Object(n.a)(i.a.mark(function e(){var t,r,n,l=arguments;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(t=l.length,r=new Array(t),n=0;n<t;n++)r[n]=l[n];if(Object(Ei.a)({type:!0}),O){e.next=16;break}return e.prev=3,e.next=6,bi.a.checkGlobalInstruction(mi.a.Picture_Resize_Instruction);case 6:if(e.sent){e.next=11;break}return k(!0),e.next=11,bi.a.setGlobalInstructionVisited(mi.a.Picture_Resize_Instruction);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),M(!0);case 16:if(!m){e.next=21;break}if(V){e.next=20;break}return new Promise(function(e,t){a&&m&&o.fabric.Image.fromURL(a.uri,function(t){e(t)})}).then(function(e){te.apply(void 0,[j,E,C].concat(r,[e]))}),e.abrupt("return");case 20:te.apply(void 0,[j,E,C].concat(r));case 21:case"end":return e.stop()}},e,this,[[3,13]])})),[j,E,C,m]);function te(e,t,a,r,i,n,l){return ae.apply(this,arguments)}function ae(){return(ae=Object(n.a)(i.a.mark(function e(t,a,r,n,l,c,s){var h,d,f,u,p;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Ii=n,Di=l,h=r.width,d=r.height,f=r.top,u=r.left,Mi=n,m){if(m.setWidth(t),m.setHeight(t),Object(Ui.a)(m,a,a),m.remove(m.getObjects().pop()),m.renderAll(),I)for(p=0;p<I.length;p++)Ii===I[p].id&&(Fi=I[p].srcUrlFill,Si=I[p].srcUrl);m.controlsAboveOverlay=!1,Fi&&(0!==xi&&"change\bShape"!==c&&"itemSwitch"!==c||(xi++,o.fabric.loadSVGFromURL(Fi,function(e,t){Ci=o.fabric.util.groupSVGElements(e,t);var a=Oi({integrationWidth:h,integrationHeight:d,integrationTop:f,integrationLeft:u,shapId:Mi,obj:Ci,imgObj:null===V?s:V,size:c,canvasSize:j,areaStyle:x,canvasArea:C});if(a){switch(a.scaleType){case"width":Ci.scaleToWidth(a.scaleNumber);break;case"height":Ci.scaleToHeight(a.scaleNumber)}if("change\bShape"===c)V?(V.set({left:"true"===a.type?C.left:a.imgObjLeft,top:a.imgObjTop,angle:0,hasControls:!1,hasBorders:!1,hasRotatingPoint:!1}).setCoords(),V.scale(a.bigMultiples)):(s.set({left:"true"===a.type?C.left:a.imgObjLeft,top:a.imgObjTop,angle:0,hasControls:!1,hasBorders:!1,hasRotatingPoint:!1}).setCoords(),s.scale(a.bigMultiples));else if("itemSwitch"===c)if(V){var r=V.top-Ai+C.top,i=V.left-Ri+C.left;V.set({left:i,top:r,hasControls:!1,hasBorders:!1,hasRotatingPoint:!1}).setCoords(),Ai=C.top,Ri=C.left}else{var n=s.top-Ai+C.top,l=s.left-Ri+C.left;s.set({left:l,top:n,hasControls:!1,hasBorders:!1,hasRotatingPoint:!1}).setCoords(),Ai=C.top,Ri=C.left}Ci.set({left:a.left-2,top:a.top+(C.height-a.width)/2,fill:"rgba(255,255,255,0)"}).setCoords(),Ci._objects&&Ci._objects[0]&&Ci._objects[0].set({fillOpacity:0,fill:"rgba(255,255,255,0)"}).setCoords(),m.clipPath=Ci,m.add(null===V?s:V),Object(Ei.a)({type:!1})}})))}case 8:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function re(){return(re=Object(n.a)(i.a.mark(function e(){var t,a,n,l,c,s,o,h,d,f,p,g,b;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(t=document.getElementById("picture_canvas"),a=parseInt(C.left),n=parseInt(C.top),l=parseInt(C.width),c=parseInt(C.height),(s=document.createElement("canvas")).width=l,s.height=c,o=s.getContext("2d"),h=0;h<16;h++)h<4?(d=t.getContext("2d").getImageData(a+h*(l/4),n,l/4,c/4),o.putImageData(d,h*(l/4),0)):h>3&&h<=7?(f=t.getContext("2d").getImageData(a+l/4*(h-4),n+c/4,l/4,c/4),o.putImageData(f,l/4*(h-4),c/4)):h>7&&h<=11?(p=t.getContext("2d").getImageData(a+l/4*(h-8),n+c/4*2,l/4,c/4),o.putImageData(p,l/4*(h-8),c/4*2)):h>11&&h<=15&&(g=t.getContext("2d").getImageData(a+l/4*(h-12),n+c/4*3,l/4,c/4),o.putImageData(g,l/4*(h-12),c/4*3));return b=s.toDataURL(),e.prev=12,e.next=15,ji.a.storeImageData({imageName:"front-".concat(r.length),imageData:b});case 15:return e.next=17,Object(fi.a)("setLayers",r);case 17:Object(fi.a)("navigateTo",{to:"/mixChoice",params:{itemModal:"show",previousPage:u}}),k(!1),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(12),M(!0);case 24:case"end":return e.stop()}},e,this,[[12,21]])}))).apply(this,arguments)}return Object(c.useEffect)(function(){if(m){var e=function(e){e.preventDefault();var t=new o.fabric.Rect({width:j,height:j,top:0,left:0});m.clipPath=t,m.renderAll();var a=document.getElementById("maskModule"),r=document.getElementById("screenshotsImg");if(r){var i=ki(x,Mi,V);i&&(r.style.width=i.width+"px",r.style.left=i.left+"px",r.style.top=i.top+"px"),r.src=Si}a.style.display="block"},t=function(e){m.clipPath=Ci,$(!1),m.renderAll(),document.getElementById("maskModule").style.display="none"},a=function(e){console.log("\u7cfb\u7edf\u9ed8\u8ba4\u4e8b\u4ef6\u89e6\u53d1\u4e86"),m.clipPath=Ci,$(!1),m.renderAll(),document.getElementById("maskModule").style.display="none"},r=m.upperCanvasEl;return r.addEventListener("touchstart",e,!1),r.addEventListener("touchend",t,!1),r.addEventListener("touchcancel",a,!1),function(){r.removeEventListener("touchstart",e,!1),r.removeEventListener("touchend",t,!1),r.removeEventListener("touchcancel",a,!1)}}},[m,x]),Object(c.useEffect)(function(){if(m)return function(){m.dispose()}},[m]),s.a.createElement("div",{style:{position:"absolute",top:0,right:0,bottom:0,left:0,overflow:"hidden"}},s.a.createElement(d.a,{page:"picture",revoke:function(){K(!0)}},s.a.createElement(vi.a,{onClick:function(){Bi&&(Bi=!1,function(){re.apply(this,arguments)}(),Li=setTimeout(function(){Bi=!0,window.clearTimeout(Li)},2e3))}})),s.a.createElement(pi.a,{topLayer:e.topLayer,data:e.mixData,noMultiply:!0},s.a.createElement("div",{style:{position:"absolute",top:0,left:0}},s.a.createElement("canvas",{id:"picture_canvas",ref:q,width:j,height:j})),s.a.createElement("div",{id:"maskModule",style:{position:"fixed",top:0,left:0,bottom:0,right:0,backgroundColor:"rgba(0,0,0,0)",display:"none",pointerEvents:"none"}},s.a.createElement("img",{style:{position:"relative"},id:"screenshotsImg",src:"",alt:"\u622a\u56fe\u5c42"}))),O?s.a.createElement(Gt.a,{moveIcon:"Drag.gif",resizeIcon:"Resize.gif",title:"make.picture.resize.title",hideTypesetProps:function(){return $(!1)}}):"",s.a.createElement(f.a,null,s.a.createElement(w,{pictureData:a,onChange:function(e){var t=o.fabric.Image.filters;"original"===e?function(){var e=m.getObjects()[0];e&&(e.filters=[],e.applyFilters(),m.renderAll())}():"high_contrast"===e?(Q(new t.Contrast({contrast:1})),Q(new t.BlackWhite)):"monochrome"===e?Q(new t.Grayscale):"fade"===e?Q(new t.ColorMatrix({matrix:[.69289941361155,.7278445092038974,-.05512249038767107,0,0,.1613074605810542,1.0992559191682274,.13496294539414613,0,0,.3215407473339169,.5219370160799921,.475247644029788,0,0,0,0,0,1,0]})):"process"===e?Q(new t.ColorMatrix({matrix:[.9923434290993866,.020245983284966663,.05808604318498348,0,0,.12115038437773568,.835385137906068,.05372603236979564,0,0,.19202559992747836,.21537620720368716,.9342355235475182,0,0,0,0,0,1,0]})):"chrome"===e&&Q(new t.ColorMatrix({matrix:[1.6625074707000003,-.12036142800000012,-.012146042700000012,0,0,-.035792529300000035,1.5779385719999999,-.012146042700000012,0,0,-.035792529300000035,-.12036142800000012,1.6861539573000002,0,0,0,0,0,1,0]}))}}),s.a.createElement(Wt,{onSelectShape:ee}),s.a.createElement(Ht.a,null)),s.a.createElement(ui.a,{status:J,isAgainFu:function(e){K(!1)}}),s.a.createElement(yi.a,{visible:B,title:"error.network.title",description:"error.network.description",text:"OK",onClick:function(){M(!1)}}))})},473:function(e,t,a){"use strict";a.d(t,"a",function(){return d});var r=a(57),i=a(0),n=a.n(i),l=a(449),c=a.n(l),s=a(459),o=a.n(s),h=a(47);function d(e){var t=e.disabled,a=e.onClick,l=e.style;return Object(i.useEffect)(function(){Object(h.a)()},[]),n.a.createElement("div",{onClick:t?null:function(){return Object(h.b)(a)}},n.a.createElement("img",{src:t?o.a:c.a,className:"GotoMixIcon",alt:"",style:Object(r.a)({position:"absolute",right:12,top:2,zIndex:11,width:40,height:40,transition:"all .4s"},l)}))}}}]);
//# sourceMappingURL=23.f2971a85.chunk.js.map